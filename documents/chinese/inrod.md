# VCFANNO注释程序

Variant Call Format，即VCF格式，是目前最常用的基因组变异信息存储格式。常见的VCF文件包括了DNA变异位点在基因组的位置，变异位点基因型，对应位点和等位基因的深度等信息。通过数据库对变异位点的各种信息进行解读最终将变异信息与表型信息关联在一起，这个过程即是变异数据看的注释。

常见的注释程序能够对变异位点的解释信息包括了：

+ 变异位点对应的基因和转录本信息；
+ 变异位点所在的基因组功能区域；
+ 变异位点在特定人群中的频率分布情况（通常情况下致病等位基因型在人群中的分布频率应低于1/2000）；
+ 变异位点在已有的疾病与基因型数据库中的记录情况；
+ DNA水平变异对蛋白质编码的影响；
+ 变异位点可靠性（变异位点被检测错的概率，包括位置的错误和基因型的错误）。

## VCF格式说明##

VCF文件包含两个部分，分别为header和body。

header出现在VCF文件的开始部分，每行以“＃”符开始。header部分的各行除最后一行为一个#外，其余各行均为两个#开始，即##。VCF文件的header部分有***严格的格式规定和设置***，不当的格式设置和人为修改会对后续分析产生很大的影响。因此建议大家熟读VCF文件格式官方说明文档（http://samtools.github.io/hts-specs/VCFv4.3.pdf）。

body部分记录了变异数据的所有信息，每行对应一个位点，根据程序输出不同也会出现同一位置不同变异类型出现在多行的情况。因此在进行与碱基相关的数据库注释时，vcfanno会根据变异位置信息提取对应坐标的数据库信息，然后检察基因型，只有位置和基因型完全一致的情况下进行注释。常规的body信息至少包含8列信息，正常的单个样品的变异信息则至少为10列，因为最后两列对应着与样品相关的变异检测参数，vcf格式的数据库则可以省略。特别的vcf文件的第八列，即INFO列，可以用来记录着与位置和基因型相关的所有信息，vcfanno的设计思路就是将所有与位置和基因型相关的信息放入到INFO列，将与样品相关的信息放入到FOMAT列（第九列之后）的方法来实现在保证现有数据格式不变的情况下进行注释。用户再根据实际需求，从注释后的vcf文件中提取感兴趣的信息并用已有的工具转化成任意格式，从而实现通用的目的。



## 流程说明

本流程包括了主程序vcfanno，除此之外还包括一些格式转换工具。



### 转换工具###

#### vcf2tsv

将VCF格式文件转换为tab键分割的文本格式。

#### tsv2vcf

#### vcf_rename_tags

#### tsv2excel



## 数据库说明

变异信息注释的核心在于数据库。这里整理和搜集了一些常用的数据库，并一一说明使用方法。



### 数据库列表

#### 基因数据库

#### 频率数据库



#### 变异数据库

##### Database of Genomic Variants (DGV)

http://dgv.tcag.ca/dgv/app/home





## 配置文件



## 程序测试





## 参考文献





